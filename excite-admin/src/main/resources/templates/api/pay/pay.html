<!doctype html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>订单支付</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Access-Control-Allow-Origin" content="*">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">

    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
    <link rel="stylesheet" href="/css/weui/weui.css"/>
    <link rel="stylesheet" href="/css/weui/weuix.css"/>
</head>

<body ontouchstart class="page-bg">

<div class="page-hd" style="background: #ffff">
    <h2 style="text-align: center">
        <img src="https://api.xunhupay.com/content/images/wechat-s.png" alt="" style="vertical-align: middle">
        微信支付收银台
    </h2>
</div>

<div class="weui-pay">
    <div style="text-align: -webkit-center;">
        <div class="weui-avatar-circle" style="width: 80px;height: 80px">
            <img src="https://www.chenxiuhao.cn/public/images/avatar.jpg" style="width: 80px;height: 80px">
            <span class="weui-icon-success weui-icon-safe-success"></span>
        </div>
    </div>

</div>
<div class="weui-pay">
    <p class="weui-pay-num">￥15.00</p>
</div>
<div class="weui-pay">
    <ul class="weui-pay-u">
        <li class="">
            <span class="title">订单标题</span>
            <span class="content">这里是订单的标题</span>
        </li>
        <li>
            <span class="title">订单编号</span>
            <span class="content">AL2022071115461180372942587630</span>
        </li>
    </ul>
</div>

<div class="weui-pay">
    <div class="pay-div">
        <a href="javascript:void(0);" onclick="wechat_jsapi_pay();" class="weui-btn weui-btn_primary">立即支付</a></div>
    <div class="pay-div">
        <a href="javascript:;" class="weui-btn weui-btn_plain-primary">取消支付</a>
    </div>
</div>

<script type="text/javascript">
    function wechat_jsapi_pay() {
        WeixinJSBridge.invoke('getBrandWCPayRequest', {
            "appId": "[[${appId}]]",
            "timeStamp": "[[${timeStamp}]]",
            "nonceStr": "[[${nonceStr}]]",
            "package": "[[${package}]]",
            "signType": "[[${signType}]]",
            "paySign": "[[${paySign}]]"
        }, function (res) {
            if (res.err_msg !== "get_brand_wcpay_request:ok" && res.err_msg !== "get_brand_wcpay_request:cancel") {
                alert(JSON.stringify(res));
                //location.href='https://api.xunhupay.com/payments/home/callback_url?id=20220728480&nonce_str=5456127336&time=1657542633&appid=201906144414&hash=3bc7e059cdd4047fe00219b198d15127';
                return;
            }
            if (res.err_msg === "get_brand_wcpay_request:cancel") {
                //location.href='https://api.xunhupay.com/payments/home/callback_url?id=20220728480&nonce_str=5456127336&time=1657542633&appid=201906144414&hash=3bc7e059cdd4047fe00219b198d15127';
                return;
            }
            location.href = 'https://www.zxdmy.com';
        });
    }

    if (typeof WeixinJSBridge == "undefined") {
        if (document.addEventListener) {
            document.addEventListener('WeixinJSBridgeReady', wechat_jsapi_pay, false);
        } else if (document.attachEvent) {
            document.attachEvent('WeixinJSBridgeReady', wechat_jsapi_pay);
            document.attachEvent('onWeixinJSBridgeReady', wechat_jsapi_pay);
        }
    } else {
        wechat_jsapi_pay();
    }
</script>

</body>
</html>